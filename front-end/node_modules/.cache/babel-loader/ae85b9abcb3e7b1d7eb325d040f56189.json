{"ast":null,"code":"import _slicedToArray from\"C:/Users/kimseonjin/Documents/GitHub/HappyHouse-Guide/front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import Moment from'react-moment';import numeral from'numeral';import'./css/Review.css';import $ from'jquery';import{Modal,ModalHeader}from'reactstrap';import star3 from'../Image/star3.png';import Pagination from'../source/Pagination';import SearchHouse from'../source/SearchHouse';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Review=function Review(props){var _useState=useState(\"0\"),_useState2=_slicedToArray(_useState,2),modalInput=_useState2[0],setModalInput=_useState2[1];var _useState3=useState(\"0\"),_useState4=_slicedToArray(_useState3,2),modalInputCode=_useState4[0],setModalInputCode=_useState4[1];var _useState5=useState(\"0\"),_useState6=_slicedToArray(_useState5,2),modalInputWriterId=_useState6[0],setModalInputWriterId=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),modalCreateReview=_useState8[0],setModalCreateReview=_useState8[1];var toggleCreateReview=function toggleCreateReview(){return setModalCreateReview(!modalCreateReview);};var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),review_list=_useState10[0],setReview=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),page=_useState12[0],setPage=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),count=_useState14[0],setCount=_useState14[1];var _useState15=useState(3),_useState16=_slicedToArray(_useState15,2),pageSize=_useState16[0],setPageSize=_useState16[1];var handleOptionOnChange=function handleOptionOnChange(e){e.preventDefault();if(e.target.value===\"최신순\"){localStorage.setItem(\"option\",0);readReview();}else{localStorage.setItem(\"option\",1);readReviewStar();}};var handlePageChange=function handlePageChange(page){localStorage.setItem(\"page\",page);if(localStorage.getItem(\"option\")==1){readReviewStar();}else readReview();};var reviewList=function reviewList(reviews){return/*#__PURE__*/_jsx(\"li\",{className:\"li\",id:reviews._id,children:/*#__PURE__*/_jsxs(\"div\",{class:\"review-block\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"id\",children:reviews._id}),/*#__PURE__*/_jsx(\"td\",{className:\"id\",children:reviews.danjiCode}),/*#__PURE__*/_jsx(\"td\",{className:\"id\",children:reviews.userId}),/*#__PURE__*/_jsx(\"div\",{id:\"header\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"header-title\",children:reviews.title})}),/*#__PURE__*/_jsx(\"div\",{class:\"review-item-description-date\",children:/*#__PURE__*/_jsx(\"span\",{class:\"review-item-description\",children:/*#__PURE__*/_jsx(\"time\",{class:\"time\",children:/*#__PURE__*/_jsx(Moment,{format:\"YY.MM.DD\",children:reviews.writeDate})})})}),/*#__PURE__*/_jsx(\"div\",{class:\"review-item-description-user\",children:/*#__PURE__*/_jsxs(\"span\",{class:\"review-item-description-title\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://cf-fpi.everytime.kr/0.png\",class:\"picture-medium\"}),/*#__PURE__*/_jsx(\"h3\",{class:\"user\",children:reviews.userId})]})}),/*#__PURE__*/_jsx(\"div\",{id:\"writer-writeDate-star\",children:/*#__PURE__*/_jsxs(\"span\",{class:\"starpoint\",children:[/*#__PURE__*/_jsx(\"img\",{src:star3}),reviews.star]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"table\",{class:\"houseInfo\",children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uB2E8\\uC9C0\\uBA85\"}),/*#__PURE__*/_jsx(\"td\",{colspan:\"3\",children:reviews.danjiName})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uC9C0\\uC5ED\"}),/*#__PURE__*/_jsx(\"td\",{children:reviews.region}),/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uC784\\uB300\\uC885\\uB958\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\uD589\\uBCF5\\uC8FC\\uD0DD\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uC720\\uD615\"}),/*#__PURE__*/_jsx(\"td\",{children:reviews.houseType}),/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uC8FC\\uD0DD\\uD615\"}),/*#__PURE__*/_jsx(\"td\",{children:reviews.typeName})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uC6D4\\uC138\"}),/*#__PURE__*/_jsx(\"td\",{children:numeral(reviews.monthlyRentCharge).format('0,0')}),/*#__PURE__*/_jsx(\"td\",{id:\"a\",children:\"\\uAD00\\uB9AC\\uBE44\"}),/*#__PURE__*/_jsx(\"td\",{children:numeral(reviews.adminCharge).format('0,0')})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{class:\"review-image\",src:reviews.picture})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"review-content\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"merit\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"b\",children:\"\\uC7A5\\uC810\"}),reviews.merit]}),/*#__PURE__*/_jsxs(\"div\",{id:\"demerit\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"b\",children:\"\\uB2E8\\uC810\"}),reviews.demerit]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"button-container\",children:/*#__PURE__*/_jsx(\"button\",{id:\"review-upload\",className:\"readReviewDetail\",onClick:readReviewDetail,children:\"\\uC218\\uC815/\\uC0AD\\uC81C\"})}),/*#__PURE__*/_jsx(\"br\",{})]})},reviews._id);};function readReviewCount(){axios.get('https://joj5opq81m.execute-api.us-east-2.amazonaws.com/happyhouse/reviews').then(function(_ref){var data=_ref.data;setCount(data.count);});}function readReview(){var form={page:localStorage.getItem(\"page\")};axios.post('https://joj5opq81m.execute-api.us-east-2.amazonaws.com/happyhouse/reviews/date',form).then(function(_ref2){var data=_ref2.data;data=data.reviewList;setReview(data.map(reviewList));});}function readReviewStar(){var form={page:localStorage.getItem(\"page\")};axios.post('https://joj5opq81m.execute-api.us-east-2.amazonaws.com/happyhouse/reviews/star',form).then(function(_ref3){var data=_ref3.data;data=data.reviewList;setReview(data.map(reviewList));});}function readReviewDetail(){if(localStorage.getItem(\"review_id\")!=\"0\"&&localStorage.getItem(\"danjiCode\")!=\"0\"){if(localStorage.getItem(\"userID\")!=localStorage.getItem(\"writerId\")){alert(\"수정 권한이 없습니다.\");window.location.href='/reviews';}else{window.location.href='/reviews/detail';}}}$(function(){$(\".createReviewButton\").on(\"click\",function(){toggleCreateReview();});$(\".readReviewDetail\").on(\"click\",function(){var Button=$(this);var div=Button.parent().parent();var td=div.children();setModalInput(td.eq(0).text());localStorage.setItem(\"review_id\",modalInput);setModalInputCode(td.eq(1).text());localStorage.setItem(\"danjiCode\",modalInputCode);setModalInputWriterId(td.eq(2).text());localStorage.setItem(\"writerId\",modalInputWriterId);});});useEffect(function(){readReviewCount();if(localStorage.getItem(\"option\")==1){readReviewStar();}else readReview();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"dv\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"review-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"review-title\",children:/*#__PURE__*/_jsx(\"div\",{id:\"title\",children:\"\\uAC70\\uC8FC \\uD6C4\\uAE30\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-button-group\",children:[/*#__PURE__*/_jsxs(\"select\",{id:\"review-search-option\",onChange:handleOptionOnChange,children:[/*#__PURE__*/_jsx(\"option\",{children:\"\\uCD5C\\uC2E0\\uC21C\"}),/*#__PURE__*/_jsx(\"option\",{children:\"\\uBCC4\\uC810\\uC21C\"})]}),/*#__PURE__*/_jsx(\"button\",{id:\"review-upload\",className:\"createReviewButton\",children:\"\\uAC70\\uC8FC\\uD6C4\\uAE30 \\uC791\\uC131\\uD558\\uAE30\"})]}),review_list]}),/*#__PURE__*/_jsx(\"div\",{id:\"center\",children:/*#__PURE__*/_jsx(\"div\",{class:\"pagination\",children:/*#__PURE__*/_jsx(Pagination,{itemsCount:count,pageSize:pageSize,currentPage:1,onPageChange:handlePageChange})})})]})}),/*#__PURE__*/_jsxs(Modal,{isOpen:modalCreateReview,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:toggleCreateReview,children:\"\\uC8FC\\uD0DD \\uAC80\\uC0C9\"}),/*#__PURE__*/_jsx(SearchHouse,{})]})]});};export default Review;","map":{"version":3,"sources":["C:/Users/kimseonjin/Documents/GitHub/HappyHouse-Guide/front-end/src/source/reviewTest.js"],"names":["React","useState","useEffect","axios","Moment","numeral","$","Modal","ModalHeader","star3","Pagination","SearchHouse","Review","props","modalInput","setModalInput","modalInputCode","setModalInputCode","modalInputWriterId","setModalInputWriterId","modalCreateReview","setModalCreateReview","toggleCreateReview","review_list","setReview","page","setPage","count","setCount","pageSize","setPageSize","handleOptionOnChange","e","preventDefault","target","value","localStorage","setItem","readReview","readReviewStar","handlePageChange","getItem","reviewList","reviews","_id","danjiCode","userId","title","writeDate","star","danjiName","region","houseType","typeName","monthlyRentCharge","format","adminCharge","picture","merit","demerit","readReviewDetail","readReviewCount","get","then","data","form","post","map","alert","window","location","href","on","Button","div","parent","td","children","eq","text"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport axios from 'axios'\r\nimport Moment from 'react-moment'\r\nimport numeral from 'numeral'\r\nimport './css/Review.css'\r\nimport $ from 'jquery';\r\nimport {Modal, ModalHeader} from 'reactstrap';\r\nimport star3 from '../Image/star3.png'\r\nimport Pagination from '../source/Pagination'\r\nimport SearchHouse from '../source/SearchHouse'\r\nconst Review = (props) => {\r\n\r\n    const [modalInput, setModalInput] = useState(\"0\");\r\n    const [modalInputCode, setModalInputCode] = useState(\"0\");\r\n    const [modalInputWriterId, setModalInputWriterId] = useState(\"0\");\r\n    const [modalCreateReview, setModalCreateReview] = useState(false);\r\n    const toggleCreateReview = () => setModalCreateReview(!modalCreateReview);\r\n    const [review_list, setReview] = useState();\r\n    const [page, setPage] = useState(1);\r\n    const [count, setCount] = useState();\r\n    const [pageSize, setPageSize] = useState(3); \r\n    const handleOptionOnChange = (e) => {\r\n        e.preventDefault();\r\n        if (e.target.value === \"최신순\") {\r\n            localStorage.setItem(\"option\", 0)\r\n\r\n            readReview();\r\n        } else {\r\n            localStorage.setItem(\"option\", 1)\r\n\r\n            readReviewStar();\r\n        }\r\n    }\r\n\r\n    const handlePageChange = (page) => {\r\n        localStorage.setItem(\"page\", page);\r\n        if (localStorage.getItem(\"option\") == 1) {\r\n\r\n            readReviewStar();\r\n        } else \r\n            readReview()\r\n    }\r\n\r\n    const reviewList = (reviews) => (\r\n        <li className=\"li\" key={reviews._id} id={reviews._id}>\r\n            <div class=\"review-block\">\r\n                <td className=\"id\">{reviews._id}</td>\r\n                <td className=\"id\">{reviews.danjiCode}</td>\r\n                <td className=\"id\">{reviews.userId}</td>\r\n                <div id=\"header\">\r\n                    <h4 className=\"header-title\">{reviews.title}</h4>\r\n                </div>\r\n                <div class=\"review-item-description-date\">\r\n                    <span class=\"review-item-description\">\r\n                        <time class=\"time\">\r\n                            <Moment format=\"YY.MM.DD\">{reviews.writeDate}</Moment>\r\n                        </time>\r\n                    </span>\r\n                </div>\r\n\r\n                <div class=\"review-item-description-user\">\r\n                    <span class=\"review-item-description-title\">\r\n                        <img src=\"https://cf-fpi.everytime.kr/0.png\" class=\"picture-medium\"></img>\r\n                        <h3 class=\"user\">{reviews.userId}</h3>\r\n                    </span>\r\n                </div>\r\n                <div id=\"writer-writeDate-star\">\r\n                    <span class=\"starpoint\">\r\n                        <img src={star3}></img>\r\n                        {reviews.star}\r\n                    </span>\r\n                </div>\r\n                <div>\r\n                    <table class=\"houseInfo\">\r\n                        <tr>\r\n                            <td id=\"a\">단지명</td>\r\n                            <td colspan=\"3\">{reviews.danjiName}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td id=\"a\">지역</td>\r\n                            <td>{reviews.region}</td>\r\n                            <td id=\"a\">임대종류</td>\r\n                            <td>행복주택</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td id=\"a\">유형</td>\r\n                            <td>{reviews.houseType}</td>\r\n                            <td id=\"a\">주택형</td>\r\n                            <td>{reviews.typeName}</td>\r\n\r\n                        </tr>\r\n                        <tr>\r\n                            <td id=\"a\">월세</td>\r\n                            <td>{numeral(reviews.monthlyRentCharge).format('0,0')}</td>\r\n                            <td id=\"a\">관리비</td>\r\n                            <td>{numeral(reviews.adminCharge).format('0,0')}</td>\r\n                        </tr>\r\n                    </table>\r\n                </div>\r\n\r\n                <div >\r\n                    <br></br>\r\n\r\n                    <img class=\"review-image\" src={reviews.picture}></img>\r\n\r\n                </div>\r\n\r\n                <div class=\"review-content\">\r\n                    <div id=\"merit\">\r\n                        <div id=\"b\">장점</div>{reviews.merit}</div>\r\n                    <div id=\"demerit\">\r\n                        <div id=\"b\">단점</div>{reviews.demerit}</div>\r\n                </div>\r\n                <br></br>\r\n                <div className=\"button-container\">\r\n                    <button id=\"review-upload\" className={\"readReviewDetail\"} onClick={readReviewDetail}>수정/삭제</button>\r\n                </div>\r\n                <br></br>\r\n\r\n            </div>\r\n\r\n        </li>\r\n    );\r\n    function readReviewCount() {\r\n\r\n        axios\r\n            .get('https://joj5opq81m.execute-api.us-east-2.amazonaws.com/happyhouse/reviews')\r\n            .then(({data}) => {\r\n                setCount(data.count);\r\n            })\r\n    }\r\n    function readReview() {\r\n        var form = {\r\n            page: localStorage.getItem(\"page\")\r\n        };\r\n        axios\r\n            .post('https://joj5opq81m.execute-api.us-east-2.amazonaws.com/happyhouse/reviews/date', form)\r\n            .then(({data}) => {\r\n                data = data.reviewList\r\n                setReview(data.map(reviewList))\r\n            })\r\n    }\r\n    function readReviewStar() {\r\n        var form = {\r\n            page: localStorage.getItem(\"page\")\r\n        };\r\n        axios\r\n            .post('https://joj5opq81m.execute-api.us-east-2.amazonaws.com/happyhouse/reviews/star', form)\r\n            .then(({data}) => {\r\n                data = data.reviewList\r\n                setReview(data.map(reviewList))\r\n            })\r\n    }\r\n    function readReviewDetail() {\r\n      \r\n     \r\n       if (localStorage.getItem(\"review_id\") != \"0\"&& localStorage.getItem(\"danjiCode\")!=\"0\") {\r\n        if(localStorage.getItem(\"userID\")!=localStorage.getItem(\"writerId\")){\r\n                    \r\n            alert(\"수정 권한이 없습니다.\")\r\n            window.location.href = '/reviews'\r\n        }else{\r\n            window.location.href = '/reviews/detail'\r\n        }\r\n    }\r\n    }\r\n    $(function () {\r\n        $(\".createReviewButton\").on(\"click\", function () {\r\n\r\n            toggleCreateReview();\r\n        })\r\n        $(\".readReviewDetail\").on(\"click\", function () {\r\n\r\n            var Button = $(this);\r\n            var div = Button\r\n                .parent()\r\n                .parent();\r\n            var td = div.children();\r\n            setModalInput(td.eq(0).text());\r\n            localStorage.setItem(\"review_id\", modalInput);\r\n            setModalInputCode(td.eq(1).text());\r\n            localStorage.setItem(\"danjiCode\",modalInputCode);\r\n            setModalInputWriterId(td.eq(2).text());\r\n            localStorage.setItem(\"writerId\",modalInputWriterId);\r\n\r\n        })\r\n    })\r\n    useEffect(() => {\r\n        readReviewCount();\r\n        if (localStorage.getItem(\"option\") == 1) {\r\n\r\n            readReviewStar();\r\n        } else \r\n            readReview()\r\n\r\n    },[]);\r\n\r\n    return (\r\n        <div>\r\n            <React.Fragment>\r\n                <div className=\"dv\">\r\n\r\n                    <div className=\"review-wrap\">\r\n                        <div className=\"review-title\">\r\n                            <div id=\"title\">거주 후기</div>\r\n                        </div>\r\n\r\n                        <div className=\"search-button-group\">\r\n\r\n                            <select id=\"review-search-option\" onChange={handleOptionOnChange}>\r\n                                <option>최신순</option>\r\n                                <option>별점순</option>\r\n                            </select>\r\n                            <button\r\n                                id=\"review-upload\"\r\n                                className={\"createReviewButton\"}>거주후기 작성하기</button>\r\n                        </div>\r\n\r\n                        {review_list}\r\n\r\n                    </div>\r\n\r\n                    <div id=\"center\">\r\n                        <div class=\"pagination\">\r\n                            <Pagination\r\n                                itemsCount={count}\r\n                                pageSize={pageSize}\r\n                                currentPage={1}\r\n                                onPageChange={handlePageChange}/>\r\n                        </div>\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </React.Fragment>\r\n\r\n            <Modal isOpen={modalCreateReview}>\r\n                <ModalHeader toggle={toggleCreateReview}>주택 검색</ModalHeader>\r\n                <SearchHouse></SearchHouse>\r\n            </Modal>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Review;"]},"metadata":{},"sourceType":"module"}